<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Current Workers · Kanaklata Agency</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <style>
    :root{
      --bg1:#ff7a18; --bg2:#af002d;
      --card:#ffffffcc; --panel:#ffffffee;
      --text:#0f172a; --muted:#64748b;
      --accent:#0ea5e9; --accent-600:#0284c7; --ring:#bae6fd;
      --radius:14px; --shadow:0 10px 30px rgba(0,0,0,.12);
      --sidebar:#0b1220cc; --sidebar-text:#e2e8f0; --sidebar-muted:#94a3b8;
    }
    *{box-sizing:border-box} html,body{height:100%}
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color:var(--text);
      background:
        radial-gradient(1200px 800px at 10% -10%, #ffd7ba 0%, transparent 60%),
        radial-gradient(1000px 700px at 90% 110%, #fecaca 0%, transparent 60%),
        linear-gradient(135deg, var(--bg1), var(--bg2));
    }
    .layout{display:grid;grid-template-columns:260px 1fr;grid-template-rows:64px 1fr;grid-template-areas:"sidebar header" "sidebar main";min-height:100vh;gap:18px;padding:18px}
    .sidebar{grid-area:sidebar;background:var(--sidebar);color:var(--sidebar-text);border-radius:var(--radius);box-shadow:var(--shadow);padding:16px;display:flex;flex-direction:column;gap:10px;backdrop-filter:blur(6px)}
    .brand{display:flex;align-items:center;gap:10px;padding:10px 12px;font-weight:800;background:#ffffff12;border:1px solid #ffffff22;border-radius:12px}
    .nav{display:flex;flex-direction:column;gap:6px;margin-top:10px}
    .nav a{color:var(--sidebar-text);text-decoration:none;padding:10px 12px;border-radius:10px;display:flex;align-items:center;gap:10px;opacity:.9;transition:.15s}
    .nav a.active,.nav a:hover{background:#0b5eaacc;opacity:1}
    .sidebar .foot{margin-top:auto;font-size:12px;color:var(--sidebar-muted)}
    .header{grid-area:header;background:var(--card);backdrop-filter:blur(8px);border:1px solid #ffffff66;border-radius:var(--radius);box-shadow:var(--shadow);padding:10px 16px;display:flex;align-items:center;justify-content:space-between}
    .main{grid-area:main;display:grid;grid-template-rows:auto 1fr;gap:18px}
    .panel{background:var(--panel);border:1px solid #ffffff66;border-radius:16px;box-shadow:var(--shadow);padding:16px;overflow:auto}
    .panel header{display:flex;align-items:center;justify-content:space-between}
    table{width:100%;border-collapse:collapse}
    thead th{font-size:12px;text-align:left;color:var(--muted);font-weight:700;padding:12px 10px;border-bottom:1px solid #e5e7eb;background:#ffffffc0;position:sticky;top:0;backdrop-filter:blur(4px)}
    tbody td{padding:12px 10px;border-bottom:1px solid #f1f5f9;font-size:14px}
    tbody tr:hover{background:#f8fafc}
    .actions{display:flex;gap:10px;flex-wrap:wrap}
    .btn{appearance:none;border:none;cursor:pointer;display:inline-flex;align-items:center;justify-content:center;gap:6px;padding:10px 14px;border-radius:10px;font-weight:700;background:linear-gradient(135deg,var(--accent),var(--accent-600));color:#fff;box-shadow:0 6px 16px rgba(2,132,199,.25);transition:transform .06s ease,box-shadow .15s ease}
    .btn:hover{transform:translateY(-1px)} .btn:active{transform:translateY(0) scale(.99)}
    .btn.secondary{background:#111827;color:#fff;box-shadow:none}
    .input{padding:10px 12px;border:1px solid #e5e7eb;border-radius:10px;outline:none;background:#fff;width:100%}
    .input:focus{border-color:var(--accent);box-shadow:0 0 0 4px var(--ring)}
    .avatar{width:64px;height:64px;border-radius:50%;object-fit:cover;border:2px solid #e5e7eb}
    #certTemplate{width:800px;max-width:100%;margin:auto;background:#fff;color:#111;padding:32px;border:2px solid #111;border-radius:12px;font-family:Georgia,'Times New Roman',serif}
    #certTemplate h1{margin:0 0 8px 0;font-size:28px;text-align:center}
    #certTemplate h3{margin:0 0 24px 0;font-weight:400;text-align:center}
    .cert-row{display:flex;justify-content:space-between;margin-top:36px}
    .cert-seal{border:3px double #444;padding:12px 18px;border-radius:999px}
    @media(max-width:1000px){.layout{gap:12px;padding:12px}}
    @media(max-width:680px){.layout{grid-template-columns:1fr;grid-template-areas:"header" "main"}.sidebar{display:none}}
  </style>
</head>
<body>
<div class="layout">
  <aside class="sidebar">
    <div class="brand">Kanaklata Agency</div>
    <nav class="nav">
      <a href="adminindex.html">Dashboard</a>
      <a class="active" href="workers.html">Workers</a>
      <a href="orders.html">Orders</a>
      <a href="payments.html">Payments</a>
      <a href="inventory.html">Inventory</a>
      <a href="reports.html">Reports</a>
      <a href="profiles.html">Profiles</a>
      <a href="daily-sales.html">Daily Sales</a>
    </nav>
    <div class="foot">© <span id="y"></span> Kanaklata Agency</div>
  </aside>

  <header class="header">
    <h3>Current Workers</h3>
    <div class="actions">
      <a class="btn" href="addworker.html">Add worker</a>
      <a class="btn secondary" href="pastworkers.html">Past workers</a>
    </div>
  </header>

  <main class="main">
    <section class="panel">
      <header><h3 style="margin:0">Present employees</h3></header>
      <table id="tbl">
        <thead><tr>
          <th>PP</th><th>Name</th><th>Aadhaar</th><th>Employee ID</th><th>Username</th><th>Role</th><th>Joined</th><th>Actions</th>
        </tr></thead>
        <tbody></tbody>
      </table>
    </section>

    <!-- Hidden certificate template -->
    <div id="certTemplate" style="display:none">
      <h1>Welcome to Kanaklata Agency</h1>
      <h3 id="certName">Certificate of Appointment</h3>
      <p>We are pleased to welcome <strong id="certEmp"></strong> as a valued member of the Kanaklata Agency team.</p>
      <div class="cert-row">
        <div>Date: <span id="certDate"></span></div>
        <div class="cert-seal">KANAKLATA AGENCY</div>
      </div>
    </div>
  </main>
</div>

<script>
  document.getElementById("y").textContent = new Date().getFullYear();

  const base='http://localhost:8080/api';
  function circle(src){return `<img class="avatar" src="${src||'https://via.placeholder.com/64'}" alt="">`;}

  async function load(){
    const data=[
      {pp:'https://i.pravatar.cc/64?img=12',firstName:'Ravi',lastName:'Kumar',aadhaar:'000000000000',employeeId:'EMP-25A123',username:'ravi.abc',role:'Loader',dateOfJoining:'2025-08-01'},
      {pp:'https://i.pravatar.cc/64?img=36',firstName:'Sita',lastName:'Devi',aadhaar:'123456789012',employeeId:'EMP-25B456',username:'sita.def',role:'Clerk',dateOfJoining:'2025-08-05'}
    ];
    const tb=document.querySelector('#tbl tbody');
    tb.innerHTML=data.map(w=>{
      const name=[w.firstName,w.middleName,w.lastName].filter(Boolean).join(' ');
      return `<tr>
        <td>${circle(w.pp)}</td>
        <td>${name}</td>
        <td>${w.aadhaar}</td>
        <td><input class="input" value="${w.employeeId}" style="max-width:140px" /></td>
        <td><input class="input" value="${w.username}" style="max-width:160px" /></td>
        <td>${w.role||'-'}</td>
        <td>${new Date(w.dateOfJoining).toLocaleDateString()}</td>
        <td class="actions">
          <button class="btn secondary" onclick="saveRow(this)">Save</button>
          <button class="btn" onclick="downloadWelcome('${name}')">Welcome PDF</button>
        </td>
      </tr>`;
    }).join('');
  }

  function saveRow(btn){
    const tr=btn.closest('tr');
    const inputs=tr.querySelectorAll('input');
    const empId=inputs[0].value.trim();
    const username=inputs[1].value.trim();
    console.log('Save to API',{empId,username});
    btn.textContent='Saved';
    setTimeout(()=>btn.textContent='Save',1200);
  }

  function downloadWelcome(name){
    const wrap=document.getElementById('certTemplate');
    document.getElementById('certEmp').textContent=name;
    document.getElementById('certName').textContent=`Appointment: ${name}`;
    document.getElementById('certDate').textContent=new Date().toLocaleDateString();
    wrap.style.display='block';
    const opt={filename:`Welcome-${name}.pdf`,html2canvas:{scale:2},jsPDF:{unit:'pt',format:'a4',orientation:'portrait'}};
    html2pdf().set(opt).from(wrap).save().then(()=>{wrap.style.display='none';});
  }

  load();
</script>
</body>
</html>
